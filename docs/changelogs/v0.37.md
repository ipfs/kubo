# Kubo changelog v0.37

<a href="https://ipshipyard.com/"><img align="right" src="https://github.com/user-attachments/assets/39ed3504-bb71-47f6-9bf8-cb9a1698f272" /></a>

This release was brought to you by the [Shipyard](https://ipshipyard.com/) team.

- [v0.37.0](#v0370)

## v0.37.0

- [Overview](#overview)
- [üî¶ Highlights](#-highlights)
  - [AutoConf: Complete control over network defaults](#autoconf-complete-control-over-network-defaults)
    - [New commands for configuration transparency and control](#new-commands-for-configuration-transparency-and-control)
  - [New IPNS publishing options](#new-ipns-publishing-options)
  - [Faster migrations with embedded tooling](#faster-migrations-with-embedded-tooling)
  - [Clear provide queue when reprovide strategy changes](#clear-provide-queue-when-reprovide-strategy-changes)
  - [ü™µ Revamped `ipfs log level` command](#-revamped-ipfs-log-level-command)
  - [üìå Named pins in `ipfs add` command](#-named-pins-in-ipfs-add-command)
  - [Custom sequence numbers in `ipfs name publish`](#custom-sequence-numbers-in-ipfs-name-publish)
  - [‚öôÔ∏è `Reprovider.Strategy` is now consistently respected](#-reprovider-strategy-is-now-consistently-respected)
  - [Removed unnecessary dependencies](#removed-unnecessary-dependencies)
  - [Improved `ipfs cid`](#improved-ipfs-cid)
  - [Deprecated `ipfs stats reprovide`](#deprecated-ipfs-stats-reprovide)
  - [üîÑ AutoRelay now uses all connected peers for relay discovery](#-autorelay-now-uses-all-connected-peers-for-relay-discovery)
- [üì¶Ô∏è Important dependency updates](#-important-dependency-updates)
- [üìù Changelog](#-changelog)
- [üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Contributors](#-contributors)

### Overview

### üî¶ Highlights

#### AutoConf: Complete control over network defaults

You can now see and control all network defaults your IPFS node uses - no more hidden, hardcoded values or mysterious behavior.

Your config file now explicitly shows `["auto"]` placeholders that resolve to curated, up-to-date network defaults. You can inspect these settings anytime, replace them with your own services, or disable the AutoConf feature entirely.

See the [AutoConf documentation](https://github.com/ipfs/kubo/blob/master/docs/config.md#autoconf) to learn more about how this system works.

**What changed behind the scenes:**

Previously, empty configuration fields like `Routing.DelegatedRouters: []` would secretly use hardcoded defaults you couldn't see or control. This system makes the implicit explicit.

When you upgrade to Kubo 0.37, your custom configurations stay exactly as you set them. Only the previously-hidden-or-hardcoded defaults become visible `"auto"` values.


##### New commands for configuration transparency and control

The `ipfs` CLI now includes powerful commands to inspect and control these settings:

**Inspect what defaults your node uses:**
```bash
# See all resolved network endpoints (no more guessing!)
ipfs config show --expand-auto

# Check exactly which bootstrap peers are configured
ipfs config Bootstrap --expand-auto

# Inspect specific config sections
ipfs config Routing.DelegatedRouters --expand-auto
ipfs config DNS.Resolvers --expand-auto
```

**Take full control when you need it:**

- Replace `"auto"` with your own routing endpoints for direct control
- Set empty lists `[]` to truly disable features (no more fallback to hidden defaults)
- Switch between automatic and manual modes with `--profile=autoconf-on|autoconf-off`
- Control the system with `AutoConf.Enabled` and customize the source with `AutoConf.URL`

**Take control of your setup:**
```bash
# Switch to fully automatic network configuration
ipfs config profiles apply autoconf-on

# Switch to manual control - explicitly set all AutoConf fields
ipfs config profiles apply autoconf-off
ipfs config Bootstrap '["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN"]'
ipfs config --json DNS.Resolvers '{".": ["https://dns.example.com/dns-query"], "eth.": ["https://dns.example.org/dns-query"]}'
ipfs config --json Routing.DelegatedRouters '["https://routing.example.net"]'
ipfs config --json Ipns.DelegatedPublishers '["https://ipns.example.com"]'

# Reset selected fields to use automatic defaults
ipfs config Bootstrap '["auto"]'
ipfs config --json DNS.Resolvers '{".": ["https://dns.example.com/dns-query"], "eth.": ["auto"]}'
```

**Use your own AutoConf manifest:**

Organizations can create custom AutoConf manifests tailored to their swarm or client needs - private networks, enterprise deployments, or specialized applications can define their own bootstrap peers, DNS resolvers, and routing endpoints.

Host your autoconf.json anywhere and configure with `AutoConf.URL`. See AutoConf format and guidance at https://conf.ipfs-mainnet.org/

#### New IPNS publishing options

Choose exactly how and where your IPNS records get published, with precise control over your publishing strategy.

**Configure delegated IPNS publishers:**

Configure HTTP endpoints for IPNS publishing using [`Ipns.DelegatedPublishers`](https://github.com/ipfs/kubo/blob/master/docs/config.md#ipnsdelegatedpublishers). Like other AutoConf fields, it supports the special `"auto"` value to use curated network defaults, or specify your own HTTP endpoints for full control over where your IPNS records are published.

**New command flags for targeted publishing:**
```bash
# Publish only to HTTP services defined in Ipns.DelegatedPublishers (skip DHT entirely)
ipfs name publish --delegated-only /ipfs/QmHash

# Publish only locally (no network requests)
ipfs name publish --allow-offline /ipfs/QmHash
```

These options let you optimize publishing for your specific use case - whether you want faster HTTP-only publishing or when loading test fixtures in CI.

#### Faster migrations with embedded tooling 

Repository migrations are now built directly into Kubo, eliminating download delays and external tool dependencies. Migrations complete instantly without network requests.

What you gain:

- **Instant startup** - migrations complete in milliseconds, not minutes
- **Work offline** - no internet connection needed for migrations 
- **Better reliability** - never get stuck because migration tools won't download or get blocked by security software

`ipfs daemon --migrate` performs migrations automatically. You can also use the `ipfs repo migrate` command with explicit `--to` flags to migrate to specific versions on demand:

- `ipfs repo migrate --to=17` - upgrade to access the latest features
- `ipfs repo migrate --to=16 --allow-downgrade` - downgrade for compatibility

This improvement applies to repository version 17 and above. Older versions still use external migration tools when needed.

> [!WARNING]
> **Legacy migration deprecation**: Support for legacy migrations that download binaries from the internet will be removed in a future version. Only embedded migrations for the last 3 releases will be supported. Users with very old repositories should update in stages rather than skipping multiple versions.

#### Clear provide queue when reprovide strategy changes

Your content sharing strategy changes take effect immediately, without old announcements interfering with your new setup.

When you change your [`Reprovider.Strategy`](https://github.com/ipfs/kubo/blob/master/docs/config.md#reproviderstrategy) configuration and restart Kubo, your provide queue automatically clears. This means only content matching your new strategy gets announced to the network - no more mixed signals or outdated announcements.

You can also manually clear the queue anytime:

- `ipfs provide clear` - instantly clear all queued content announcements for debugging

Gain precise control over what content your node announces, ensuring your sharing strategy works exactly as intended.

> [!NOTE]
> Upgrading to Kubo 0.37 will automatically clear any preexisting provide queue. The next time `Reprovider.Interval` hits, `Reprovider.Strategy` will be executed on a clean slate, ensuring consistent behavior with your current configuration.

#### ü™µ Revamped `ipfs log level` command

The `ipfs log level` command has been completely revamped to support both getting and setting log levels with a unified interface.

**New: Getting log levels**

- `ipfs log level` - Shows default level only
- `ipfs log level all` - Shows log level for every subsystem, including default level
- `ipfs log level foo` - Shows log level for a specific subsystem only
- Kubo RPC API: `POST /api/v0/log/level?arg=<subsystem>`

**Enhanced: Setting log levels**

- `ipfs log level foo debug` - Sets "foo" subsystem to "debug" level
- `ipfs log level all info` - Sets all subsystems to "info" level (convenient, no escaping)
- `ipfs log level '*' info` - Equivalent to above but requires shell escaping
- `ipfs log level foo default` - Sets "foo" subsystem to current default level

The command now provides full visibility into your current logging configuration while maintaining full backward compatibility. Both `all` and `*` work for specifying all subsystems, with `all` being more convenient since it doesn't require shell escaping.

#### üß∑ Named pins in `ipfs add` command

Added `--pin-name` flag to `ipfs add` for assigning names to pins.

```console
$ ipfs add --pin-name=testname cat.jpg
added bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi cat.jpg

$ ipfs pin ls --names
bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi recursive testname
```

#### ‚öôÔ∏è `Reprovider.Strategy` is now consistently respected

Prior to this version, files added, blocks received etc. were "provided" to the network (announced on the DHT) regardless of the ["reproviding strategy" setting](https://github.com/ipfs/kubo/blob/master/docs/config.md#reproviderstrategy). For example:

- Strategy set to "pinned" + `ipfs add --pin=false` ‚Üí file was provided regardless
- Strategy set to "roots" + `ipfs pin add` ‚Üí all blocks (not only the root) were provided

Only the periodic "reproviding" action (runs every 22h by default) respected the strategy.

This was inefficient as content that should not be provided was getting provided once. Now all operations respect `Reprovider.Strategy`. If set to "roots", no blocks other than pin roots will be provided regardless of what is fetched, added etc.

> [!NOTE]
> **Behavior change:** The `--offline` flag no longer affects providing behavior. Both `ipfs add` and `ipfs --offline add` now provide blocks according to the reproviding strategy when run against an online daemon (previously `--offline add` did not provide). Since `ipfs add` has been nearly as fast as offline mode [since v0.35](https://github.com/ipfs/kubo/blob/master/docs/changelogs/v0.35.md#fast-ipfs-add-in-online-mode), `--offline` is rarely needed. To run truly offline operations, use `ipfs --offline daemon`.

#### Removed unnecessary dependencies

Kubo has been cleaned up by removing unnecessary dependencies and packages:

- Removed `thirdparty/assert` (replaced by `github.com/stretchr/testify/require`)
- Removed `thirdparty/dir` (replaced by `misc/fsutil`)
- Removed `thirdparty/notifier` (unused)
- Removed `goprocess` dependency (replaced with native Go `context` patterns)

These changes reduce the dependency footprint while improving code maintainability and following Go best practices.

#### Custom sequence numbers in `ipfs name publish`

Added `--sequence` flag to `ipfs name publish` for setting custom sequence numbers in IPNS records. This enables advanced use cases like manually coordinating updates across multiple nodes. See `ipfs name publish --help` for details.

#### Improved `ipfs cid`

Certain `ipfs cid` commands can now be run without a daemon or repository, and return correct exit code 1 on error, making it easier to perform CID conversion in scripts and CI/CD pipelines.

While at it, we also fixed unicode support in `ipfs cid bases --prefix` to correctly show `base256emoji` üöÄ :-)

#### Deprecated `ipfs stats reprovide`

The `ipfs stats reprovide` command has moved to `ipfs provide stat`. This was done to organize provider commands in one location.

> [!NOTE]
> `ipfs stats reprovide` still works, but is marked as deprecated and will be removed in a future release.

#### üîÑ AutoRelay now uses all connected peers for relay discovery

AutoRelay's relay discovery now includes all connected peers as potential relay candidates, not just peers discovered through the DHT. This allows peers connected via HTTP routing and manual `ipfs swarm connect` commands to serve as relays, improving connectivity for nodes using non-DHT routing configurations.

#### üì¶Ô∏è Important dependency updates

- update `go-libp2p` to [v0.43.0](https://github.com/libp2p/go-libp2p/releases/tag/v0.43.0) (incl. [v0.42.1](https://github.com/libp2p/go-libp2p/releases/tag/v0.42.1))
- update `p2p-forge/client` to [v0.6.1](https://github.com/ipshipyard/p2p-forge/releases/tag/v0.6.1)
- update `boxo` to [v0.33.1](https://github.com/ipfs/boxo/releases/tag/v0.33.1)
- update `ipfs-webui` to [v4.8.0](https://github.com/ipfs/ipfs-webui/releases/tag/v4.8.0)
- update to [Go 1.25](https://go.dev/doc/go1.25)

### üìù Changelog

### üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Contributors
